<!DOCTYPE html>
<html>
<head>
<title>Pheenix: Routine at 74A4</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="72C9.html">72C9</a>
</td>
<td class="up">Up: <a href="../maps/all.html#74a4">Map</a></td>
<td class="next">
Next: <a href="7564.html">7564</a>
</td>
</tr>
</table>
<div class="description">74A4: Game Intro</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="72C9.html">72C9</a>.
</div>
<div class="paragraph">
<table class="">
<tr>
<td class="" colspan="1" rowspan="1"><img alt="level-01" src="../images/scr/level-01.png" /></td>
</tr>
</table>
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">GameIntro</td>
<td class="address-2"><span id="74a4"></span>74A4</td>
<td class="instruction">CALL <a href="6720.html">ClearScreen</a></td>
<td class="comment-1" rowspan="1">Call <a href="6720.html">ClearScreen</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="74a7"></span>
<div class="comments">
<div class="paragraph">
Don't bother with the animation if this is the demo mode.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74a7"></span>74A7</td>
<td class="instruction">LD A,($66F3)</td>
<td class="comment-1" rowspan="3">Return if *<a href="66F3.html">Flag_ActiveDemoMode</a> is active.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74aa"></span>74AA</td>
<td class="instruction">OR A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74ab"></span>74AB</td>
<td class="instruction">RET NZ</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="74ac"></span>
<div class="comments">
<div class="paragraph">
Set the attribute buffer to all cyan.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74ac"></span>74AC</td>
<td class="instruction">LD HL,$5800</td>
<td class="comment-1" rowspan="5">Copy CYAN to 0300 bytes starting from 5800 in the attribute buffer.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74af"></span>74AF</td>
<td class="instruction">LD DE,$5801</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74b2"></span>74B2</td>
<td class="instruction">LD BC,$02FF</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74b5"></span>74B5</td>
<td class="instruction">LD (HL),$05</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74b7"></span>74B7</td>
<td class="instruction">LDIR</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74b9"></span>74B9</td>
<td class="instruction">LD HL,$6C13</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="6C13.html">Table_MusicData</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74bc"></span>74BC</td>
<td class="instruction">LD B,$2E</td>
<td class="comment-1" rowspan="1">Set a counter in <span class="register">B</span> for 2E stars to draw.</td>
</tr>
<tr>
<td class="asm-label">GameIntro_StarLoop</td>
<td class="address-2"><span id="74be"></span>74BE</td>
<td class="instruction">LD A,B</td>
<td class="comment-1" rowspan="3">Jump to <a href="74A4.html#74e3">GameIntro_MusicLoop</a> if <span class="register">B</span> is greater than or equal to 2D.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74bf"></span>74BF</td>
<td class="instruction">CP $2D</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74c1"></span>74C1</td>
<td class="instruction">JR NC,<a href="74A4.html#74e3">GameIntro_MusicLoop</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="74c3"></span>
<div class="comments">
<div class="paragraph">
Check if the control method is the Kempston joystick?
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74c3"></span>74C3</td>
<td class="instruction">LD A,($66F6)</td>
<td class="comment-1" rowspan="3">Jump to <a href="74A4.html#74d3">GameIntro_CheckAGF</a> if *<a href="66F6.html">ControlMethod</a> is not the Kempston joystick.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74c6"></span>74C6</td>
<td class="instruction">CP $02</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74c8"></span>74C8</td>
<td class="instruction">JR NZ,<a href="74A4.html#74d3">GameIntro_CheckAGF</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="74ca"></span>
<div class="comments">
<div class="paragraph">
The control method is Kempston joystick, so test the fire button.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74ca"></span>74CA</td>
<td class="instruction">IN A,($1F)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=read from the Kempston joystick port.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74cc"></span>74CC</td>
<td class="instruction">AND %00010000</td>
<td class="comment-1" rowspan="2">Jump to <a href="74A4.html#7558">GameIntro_Done</a> if the fire button was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74ce"></span>74CE</td>
<td class="instruction">JP NZ,<a href="74A4.html#7558">GameIntro_Done</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74d1"></span>74D1</td>
<td class="instruction">JR <a href="74A4.html#74e3">GameIntro_MusicLoop</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="74A4.html#74e3">GameIntro_MusicLoop</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="74d3"></span>
<div class="comments">
<div class="paragraph">
Check if the control method is the AGF joystick?
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">GameIntro_CheckAGF</td>
<td class="address-2"><span id="74d3"></span>74D3</td>
<td class="instruction">CP $01</td>
<td class="comment-1" rowspan="2">Jump to <a href="74A4.html#74db">GameIntro_IsKeyboard</a> if *<a href="66F6.html">ControlMethod</a> is not the AGF joystick.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74d5"></span>74D5</td>
<td class="instruction">JR NZ,<a href="74A4.html#74db">GameIntro_IsKeyboard</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74d7"></span>74D7</td>
<td class="instruction">LD A,$EF</td>
<td class="comment-1" rowspan="1"><table class="default">
<tr>
<th colspan="1" rowspan="2">Port Number</th>
<th colspan="5" rowspan="1">Bit</th>
</tr>
<tr>
<th colspan="1" rowspan="1">0</th>
<th colspan="1" rowspan="1">1</th>
<th colspan="1" rowspan="1">2</th>
<th colspan="1" rowspan="1">3</th>
<th colspan="1" rowspan="1">4</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">EF</td>
<td class="centre" colspan="1" rowspan="1">0</td>
<td class="centre" colspan="1" rowspan="1">9</td>
<td class="centre" colspan="1" rowspan="1">8</td>
<td class="centre" colspan="1" rowspan="1">7</td>
<td class="centre" colspan="1" rowspan="1">6</td>
</tr>
</table></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74d9"></span>74D9</td>
<td class="instruction">JR <a href="74A4.html#74dd">GameIntro_CheckFireButton</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="74A4.html#74dd">GameIntro_CheckFireButton</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="74db"></span>
<div class="comments">
<div class="paragraph">
Else, the only control option left is the keyboard.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">GameIntro_IsKeyboard</td>
<td class="address-2"><span id="74db"></span>74DB</td>
<td class="instruction">LD A,$7F</td>
<td class="comment-1" rowspan="1"><table class="default">
<tr>
<th colspan="1" rowspan="2">Port Number</th>
<th colspan="5" rowspan="1">Bit</th>
</tr>
<tr>
<th colspan="1" rowspan="1">0</th>
<th colspan="1" rowspan="1">1</th>
<th colspan="1" rowspan="1">2</th>
<th colspan="1" rowspan="1">3</th>
<th colspan="1" rowspan="1">4</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">7F</td>
<td class="centre" colspan="1" rowspan="1">SPACE</td>
<td class="centre" colspan="1" rowspan="1">FULL-STOP</td>
<td class="centre" colspan="1" rowspan="1">M</td>
<td class="centre" colspan="1" rowspan="1">N</td>
<td class="centre" colspan="1" rowspan="1">B</td>
</tr>
</table></td>
</tr>
<tr>
<td class="asm-label">GameIntro_CheckFireButton</td>
<td class="address-2"><span id="74dd"></span>74DD</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-1" rowspan="1">Read from the keyboard.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74df"></span>74DF</td>
<td class="instruction">BIT 0,A</td>
<td class="comment-1" rowspan="2">Jump to <a href="74A4.html#7558">GameIntro_Done</a> if the fire button was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74e1"></span>74E1</td>
<td class="instruction">JR Z,<a href="74A4.html#7558">GameIntro_Done</a></td>
</tr>
<tr>
<td class="asm-label">GameIntro_MusicLoop</td>
<td class="address-2"><span id="74e3"></span>74E3</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash the star counter on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74e4"></span>74E4</td>
<td class="instruction">LD C,(HL)</td>
<td class="comment-1" rowspan="3">Fetch the pitch from the music data pointer.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74e5"></span>74E5</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74e6"></span>74E6</td>
<td class="instruction">LD B,(HL)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74e7"></span>74E7</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="2">Fetch the duration from the music data pointer.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74e8"></span>74E8</td>
<td class="instruction">LD E,(HL)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74e9"></span>74E9</td>
<td class="instruction">LD D,$01</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=01.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74eb"></span>74EB</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">Move the music data pointer to the next byte.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74ec"></span>74EC</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Stash the music data pointer on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74ed"></span>74ED</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="2"><span class="register">HL</span>=<span class="register">BC</span> (using the stack).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74ee"></span>74EE</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74ef"></span>74EF</td>
<td class="instruction">CALL $03B5</td>
<td class="comment-1" rowspan="1">Call <a "noopener nofollow" href="https://skoolkit.ca/disassemblies/rom/hex/asm/03B5.html">BEEPER</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74f2"></span>74F2</td>
<td class="instruction">DI</td>
<td class="comment-1" rowspan="1">Disable interrupts.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74f3"></span>74F3</td>
<td class="instruction">LD HL,$57DF</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=57DF (screen buffer location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74f6"></span>74F6</td>
<td class="instruction">LD DE,$57FF</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=57FF (screen buffer location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74f9"></span>74F9</td>
<td class="instruction">LD C,$03</td>
<td class="comment-1" rowspan="1"><span class="register">C</span>=03.</td>
</tr>
<tr>
<td class="asm-label">GameIntro_0</td>
<td class="address-2"><span id="74fb"></span>74FB</td>
<td class="instruction">LD B,$08</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=08.</td>
</tr>
<tr>
<td class="asm-label">GameIntro_1</td>
<td class="address-2"><span id="74fd"></span>74FD</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="3">Stash <span class="register">BC</span>, <span class="register">HL</span> and <span class="register">DE</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74fe"></span>74FE</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="74ff"></span>74FF</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7500"></span>7500</td>
<td class="instruction">LD BC,$00E0</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=00E0.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7503"></span>7503</td>
<td class="instruction">LDDR</td>
<td class="comment-1" rowspan="1">LDDR.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7505"></span>7505</td>
<td class="instruction">LD C,$20</td>
<td class="comment-1" rowspan="1"><span class="register">C</span>=20.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7507"></span>7507</td>
<td class="instruction">LD L,$FF</td>
<td class="comment-1" rowspan="1"><span class="register">L</span>=FF.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7509"></span>7509</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="3">Jump to <a href="74A4.html#7513">GameIntro_2</a> if <span class="register">H</span> is less than 47.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="750a"></span>750A</td>
<td class="instruction">CP $47</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="750c"></span>750C</td>
<td class="instruction">JR C,<a href="74A4.html#7513">GameIntro_2</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="750e"></span>750E</td>
<td class="instruction">SUB $07</td>
<td class="comment-1" rowspan="2">Subtract 07 and store the result in <span class="register">H</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7510"></span>7510</td>
<td class="instruction">LD H,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7511"></span>7511</td>
<td class="instruction">LDDR</td>
<td class="comment-1" rowspan="1">LDDR.</td>
</tr>
<tr>
<td class="asm-label">GameIntro_2</td>
<td class="address-2"><span id="7513"></span>7513</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="2">Restore <span class="register">DE</span> and <span class="register">HL</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7514"></span>7514</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7515"></span>7515</td>
<td class="instruction">DEC D</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">D</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7516"></span>7516</td>
<td class="instruction">DEC H</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">H</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7517"></span>7517</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore <span class="register">BC</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7518"></span>7518</td>
<td class="instruction">DJNZ <a href="74A4.html#74fd">GameIntro_1</a></td>
<td class="comment-1" rowspan="1">Decrease counter by one and loop back to <a href="74A4.html#74fd">GameIntro_1</a> until counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="751a"></span>751A</td>
<td class="instruction">DEC C</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">C</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="751b"></span>751B</td>
<td class="instruction">JR NZ,<a href="74A4.html#74fb">GameIntro_0</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="74A4.html#74fb">GameIntro_0</a> until <span class="register">C</span> is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="751d"></span>751D</td>
<td class="instruction">LD H,$40</td>
<td class="comment-1" rowspan="1"><span class="register">H</span>=40.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="751f"></span>751F</td>
<td class="instruction">LD B,$08</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=08.</td>
</tr>
<tr>
<td class="asm-label">GameIntro_3</td>
<td class="address-2"><span id="7521"></span>7521</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash <span class="register">BC</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7522"></span>7522</td>
<td class="instruction">LD BC,$001F</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=001F.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7525"></span>7525</td>
<td class="instruction">LD D,H</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=<span class="register">H</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7526"></span>7526</td>
<td class="instruction">LD L,B</td>
<td class="comment-1" rowspan="1"><span class="register">L</span>=<span class="register">B</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7527"></span>7527</td>
<td class="instruction">LD E,$01</td>
<td class="comment-1" rowspan="1"><span class="register">E</span>=01.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7529"></span>7529</td>
<td class="instruction">LD (HL),B</td>
<td class="comment-1" rowspan="1">Write <span class="register">B</span> to *<span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="752a"></span>752A</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="1">LDIR.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="752c"></span>752C</td>
<td class="instruction">INC H</td>
<td class="comment-1" rowspan="1">Increment <span class="register">H</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="752d"></span>752D</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore <span class="register">BC</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="752e"></span>752E</td>
<td class="instruction">DJNZ <a href="74A4.html#7521">GameIntro_3</a></td>
<td class="comment-1" rowspan="1">Decrease counter by one and loop back to <a href="74A4.html#7521">GameIntro_3</a> until counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7530"></span>7530</td>
<td class="instruction">LD HL,$61DB</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="61DB.html">Graphics_StarLarge</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="7533"></span>
<div class="comments">
<div class="paragraph">
Draw two stars; one large and one small.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7533"></span>7533</td>
<td class="instruction">LD B,$02</td>
<td class="comment-1" rowspan="1">Set a counter in <span class="register">B</span> for the number of types of stars to draw.</td>
</tr>
<tr>
<td class="asm-label">GameIntro_DrawStar_Loop</td>
<td class="address-2"><span id="7535"></span>7535</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash the star type counter on the stack.</td>
</tr>
<tr>
<td class="asm-label">GameIntro_4</td>
<td class="address-2"><span id="7536"></span>7536</td>
<td class="instruction">CALL <a href="670E.html">GenerateRandomNumber</a></td>
<td class="comment-1" rowspan="1">Call <a href="670E.html">GenerateRandomNumber</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7539"></span>7539</td>
<td class="instruction">AND %00011111</td>
<td class="comment-1" rowspan="1">Keep only bits 0-4.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="753b"></span>753B</td>
<td class="instruction">JR Z,<a href="74A4.html#7536">GameIntro_4</a></td>
<td class="comment-1" rowspan="3">Jump to <a href="74A4.html#7536">GameIntro_4</a> if <span class="register">H</span> is equal to 02 or <span class="register">A</span> is equal to 1F.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="753d"></span>753D</td>
<td class="instruction">CP $1F</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="753f"></span>753F</td>
<td class="instruction">JR Z,<a href="74A4.html#7536">GameIntro_4</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7541"></span>7541</td>
<td class="instruction">LD E,A</td>
<td class="comment-1" rowspan="1"><span class="register">E</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7542"></span>7542</td>
<td class="instruction">LD D,$40</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=40.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7544"></span>7544</td>
<td class="instruction">LD B,$08</td>
<td class="comment-1" rowspan="1">Set a line counter in <span class="register">B</span> (08 lines in a UDG).</td>
</tr>
<tr>
<td class="asm-label">GameIntro_DrawStar_LineLoop</td>
<td class="address-2"><span id="7546"></span>7546</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="2">Copy the UDG data to the screen buffer.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7547"></span>7547</td>
<td class="instruction">LD (DE),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7548"></span>7548</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">Move to the next UDG graphic data byte.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7549"></span>7549</td>
<td class="instruction">INC D</td>
<td class="comment-1" rowspan="1">Move down one pixel line in the screen buffer.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="754a"></span>754A</td>
<td class="instruction">DJNZ <a href="74A4.html#7546">GameIntro_DrawStar_LineLoop</a></td>
<td class="comment-1" rowspan="1">Decrease the line counter by one and loop back to <a href="74A4.html#7546">GameIntro_DrawStar_LineLoop</a> until all 08 lines of the UDG character have been drawn.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="754c"></span>754C</td>
<td class="instruction">LD HL,$624B</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="624B.html">Graphics_StarSmall</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="754f"></span>754F</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore the star type counter from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7550"></span>7550</td>
<td class="instruction">DJNZ <a href="74A4.html#7535">GameIntro_DrawStar_Loop</a></td>
<td class="comment-1" rowspan="1">Decrease star type counter by one and loop back to <a href="74A4.html#7535">GameIntro_DrawStar_Loop</a> until both types of star have been drawn.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7552"></span>7552</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="2">Restore the music data pointer and star counter from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7553"></span>7553</td>
<td class="instruction">POP BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7554"></span>7554</td>
<td class="instruction">DEC B</td>
<td class="comment-1" rowspan="1">Decrease the star counter by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7555"></span>7555</td>
<td class="instruction">JP NZ,<a href="74A4.html#74be">GameIntro_StarLoop</a></td>
<td class="comment-1" rowspan="1">Jump back to <a href="74A4.html#74be">GameIntro_StarLoop</a> until all the stars have been drawn.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="7558"></span>
<div class="comments">
<div class="paragraph">
The animation is finished.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">GameIntro_Done</td>
<td class="address-2"><span id="7558"></span>7558</td>
<td class="instruction">CALL <a href="6720.html">ClearScreen</a></td>
<td class="comment-1" rowspan="1">Call <a href="6720.html">ClearScreen</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="755b"></span>755B</td>
<td class="instruction">LD BC,$0000</td>
<td class="comment-1" rowspan="1">Set a counter in <span class="register">BC</span> of 0000.</td>
</tr>
<tr>
<td class="asm-label">GameIntro_Done_PauseLoop</td>
<td class="address-2"><span id="755e"></span>755E</td>
<td class="instruction">DJNZ <a href="74A4.html#755e">GameIntro_Done_PauseLoop</a></td>
<td class="comment-1" rowspan="1">Decrease the pause counter by one and loop back to <a href="74A4.html#755e">GameIntro_Done_PauseLoop</a> until the counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7560"></span>7560</td>
<td class="instruction">DEC C</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">C</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7561"></span>7561</td>
<td class="instruction">JR NZ,<a href="74A4.html#755e">GameIntro_Done_PauseLoop</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="74A4.html#755e">GameIntro_Done_PauseLoop</a> until <span class="register">C</span> is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7563"></span>7563</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="72C9.html">72C9</a>
</td>
<td class="up">Up: <a href="../maps/all.html#74a4">Map</a></td>
<td class="next">
Next: <a href="7564.html">7564</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1983 Megadodo Software &copy; 2025 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.6.</div>
<div class="repository">Link to <a rel="noopener nofollow" href="https://github.com/pobtastic/pheenix/">Source code</a>.</div>
<div><a href="../dec/asm/29860.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>