<!DOCTYPE html>
<html>
<head>
<title>Pheenix: Routine at 7069</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="6CEE.html">6CEE</a>
</td>
<td class="up">Up: <a href="../maps/all.html#7069">Map</a></td>
<td class="next">
Next: <a href="70E7.html">70E7</a>
</td>
</tr>
</table>
<div class="description">7069: Routine at 7069</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="6CEE.html">6CEE</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="7069"></span>7069</td>
<td class="instruction">DI</td>
<td class="comment-1" rowspan="1">Disable interrupts.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="706a"></span>
<div class="comments">
<div class="paragraph">
Check if the control method is the Kempson joystick?
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="706a"></span>706A</td>
<td class="instruction">LD A,($66F6)</td>
<td class="comment-1" rowspan="3">Jump to <a href="7069.html#7077">Player_Input_AGF</a> if *<a href="66F6.html">ControlMethod</a> is not the Kempston joystick.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="706d"></span>706D</td>
<td class="instruction">CP $02</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="706f"></span>706F</td>
<td class="instruction">JR NZ,<a href="7069.html#7077">Player_Input_AGF</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="7071"></span>
<div class="comments">
<div class="paragraph">
The control method is Kempston joystick, so test the fire button.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7071"></span>7071</td>
<td class="instruction">IN A,($1F)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=read from the Kempston joystick port.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7073"></span>7073</td>
<td class="instruction">AND %00010000</td>
<td class="comment-1" rowspan="1">Keep only bit 4 (the fire button input).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7075"></span>7075</td>
<td class="instruction">JR <a href="7069.html#708a">$708A</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="7069.html#708a">708A</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="7077"></span>
<div class="comments">
<div class="paragraph">
Check if the control method is the AGF joystick?
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Player_Input_AGF</td>
<td class="address-2"><span id="7077"></span>7077</td>
<td class="instruction">CP $01</td>
<td class="comment-1" rowspan="2">Jump to <a href="7069.html#707f">Player_Input_Keyboard</a> if *<a href="66F6.html">ControlMethod</a> is not the AGF joystick.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7079"></span>7079</td>
<td class="instruction">JR NZ,<a href="7069.html#707f">Player_Input_Keyboard</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="707b"></span>707B</td>
<td class="instruction">LD A,$EF</td>
<td class="comment-1" rowspan="1"><table class="default">
<tr>
<th colspan="1" rowspan="2">Port Number</th>
<th colspan="5" rowspan="1">Bit</th>
</tr>
<tr>
<th colspan="1" rowspan="1">0</th>
<th colspan="1" rowspan="1">1</th>
<th colspan="1" rowspan="1">2</th>
<th colspan="1" rowspan="1">3</th>
<th colspan="1" rowspan="1">4</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">EF</td>
<td class="centre" colspan="1" rowspan="1">0</td>
<td class="centre" colspan="1" rowspan="1">9</td>
<td class="centre" colspan="1" rowspan="1">8</td>
<td class="centre" colspan="1" rowspan="1">7</td>
<td class="centre" colspan="1" rowspan="1">6</td>
</tr>
</table></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="707d"></span>707D</td>
<td class="instruction">JR <a href="7069.html#7081">$7081</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="7069.html#7081">7081</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="707f"></span>
<div class="comments">
<div class="paragraph">
Else, the only control option left is the keyboard.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Player_Input_Keyboard</td>
<td class="address-2"><span id="707f"></span>707F</td>
<td class="instruction">LD A,$7F</td>
<td class="comment-1" rowspan="1"><table class="default">
<tr>
<th colspan="1" rowspan="2">Port Number</th>
<th colspan="5" rowspan="1">Bit</th>
</tr>
<tr>
<th colspan="1" rowspan="1">0</th>
<th colspan="1" rowspan="1">1</th>
<th colspan="1" rowspan="1">2</th>
<th colspan="1" rowspan="1">3</th>
<th colspan="1" rowspan="1">4</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">7F</td>
<td class="centre" colspan="1" rowspan="1">SPACE</td>
<td class="centre" colspan="1" rowspan="1">FULL-STOP</td>
<td class="centre" colspan="1" rowspan="1">M</td>
<td class="centre" colspan="1" rowspan="1">N</td>
<td class="centre" colspan="1" rowspan="1">B</td>
</tr>
</table></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="7081"></span>7081</td>
<td class="instruction">IN A,($FE)</td>
<td class="comment-1" rowspan="1">Read from the keyboard.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7083"></span>7083</td>
<td class="instruction">AND %00000001</td>
<td class="comment-1" rowspan="1">Keep only bit 0.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="7085"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a href="6CEE.html">6CEE</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="7085"></span>7085</td>
<td class="instruction">LD A,$10</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=10.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7087"></span>7087</td>
<td class="instruction">JR Z,<a href="7069.html#708a">$708A</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="7069.html#708a">708A</a> if ?? is equal to 10.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7089"></span>7089</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=00.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="708a"></span>708A</td>
<td class="instruction">LD ($6696),A</td>
<td class="comment-1" rowspan="1">Write <span class="register">A</span> to *<a href="6696.html">6696</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="708d"></span>708D</td>
<td class="instruction">CP C</td>
<td class="comment-1" rowspan="2">Jump to <a href="70E7.html#714e">714E</a> if <span class="register">A</span> is equal to <span class="register">C</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="708e"></span>708E</td>
<td class="instruction">JP Z,<a href="70E7.html#714e">$714E</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7091"></span>7091</td>
<td class="instruction">OR A</td>
<td class="comment-1" rowspan="2">Jump to <a href="70E7.html#714e">714E</a> if <span class="register">A</span> is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7092"></span>7092</td>
<td class="instruction">JP Z,<a href="70E7.html#714e">$714E</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7095"></span>7095</td>
<td class="instruction">LD A,($66F3)</td>
<td class="comment-1" rowspan="3">Jump to <a href="7069.html#70b8">70B8</a> if *<a href="66F3.html">66F3</a> is not zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7098"></span>7098</td>
<td class="instruction">OR A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="7099"></span>7099</td>
<td class="instruction">JR NZ,<a href="7069.html#70b8">$70B8</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="709b"></span>709B</td>
<td class="instruction">PUSH DE</td>
<td class="comment-1" rowspan="1">Stash <span class="register">DE</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="709c"></span>709C</td>
<td class="instruction">LD B,$16</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=16.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="709e"></span>709E</td>
<td class="instruction">LD HL,$0052</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=0052.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="70a1"></span>70A1</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="2">Stash <span class="register">BC</span> and <span class="register">HL</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70a2"></span>70A2</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70a3"></span>70A3</td>
<td class="instruction">LD A,$10</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=INK:BLACK,
PAPER:RED.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70a5"></span>70A5</td>
<td class="instruction">DI</td>
<td class="comment-1" rowspan="1">Disable interrupts.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70a6"></span>70A6</td>
<td class="instruction">OUT ($FE),A</td>
<td class="comment-1" rowspan="1">Set border to the colour held by <span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70a8"></span>70A8</td>
<td class="instruction">LD DE,$0001</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=0001.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70ab"></span>70AB</td>
<td class="instruction">CALL $03B5</td>
<td class="comment-1" rowspan="1">Call <a "noopener nofollow" href="https://skoolkit.ca/disassemblies/rom/hex/asm/03B5.html">BEEPER</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70ae"></span>70AE</td>
<td class="instruction">DI</td>
<td class="comment-1" rowspan="1">Disable interrupts.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70af"></span>70AF</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore <span class="register">HL</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70b0"></span>70B0</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="4">Increment <span class="register">HL</span> by four.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70b1"></span>70B1</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70b2"></span>70B2</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70b3"></span>70B3</td>
<td class="instruction">INC HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70b4"></span>70B4</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore <span class="register">BC</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70b5"></span>70B5</td>
<td class="instruction">DJNZ <a href="7069.html#70a1">$70A1</a></td>
<td class="comment-1" rowspan="1">Decrease counter by one and loop back to <a href="7069.html#70a1">70A1</a> until counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70b7"></span>70B7</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="1">Restore <span class="register">DE</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="70b8"></span>70B8</td>
<td class="instruction">LD A,($66ED)</td>
<td class="comment-1" rowspan="3"><span class="register">L</span>=*<a href="66ED.html">66ED</a>-1F.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70bb"></span>70BB</td>
<td class="instruction">SUB $1F</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70bd"></span>70BD</td>
<td class="instruction">LD L,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70be"></span>70BE</td>
<td class="instruction">LD H,$5A</td>
<td class="comment-1" rowspan="1"><span class="register">H</span>=5A.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70c0"></span>70C0</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="3">Jump to <a href="70E7.html#714e">714E</a> if *<span class="register">HL</span> is not zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70c1"></span>70C1</td>
<td class="instruction">OR A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70c2"></span>70C2</td>
<td class="instruction">JP NZ,<a href="70E7.html#714e">$714E</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70c5"></span>70C5</td>
<td class="instruction">LD (HL),$47</td>
<td class="comment-1" rowspan="1">Write INK:WHITE,
PAPER:BLACK(BRIGHT) to *<span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70c7"></span>70C7</td>
<td class="instruction">CALL <a href="6704.html">ConvertScreenToAttributeAddress</a></td>
<td class="comment-1" rowspan="1">Call <a href="6704.html">ConvertScreenToAttributeAddress</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70ca"></span>70CA</td>
<td class="instruction">SET 2,H</td>
<td class="comment-1" rowspan="1">Set bit 2 of <span class="register">H</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70cc"></span>70CC</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Stash <span class="register">HL</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70cd"></span>70CD</td>
<td class="instruction">LD A,($66A6)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<a href="66A6.html">66A6</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70d0"></span>70D0</td>
<td class="instruction">OR A</td>
<td class="comment-1" rowspan="1">Set the bits from <span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70d1"></span>70D1</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70d2"></span>70D2</td>
<td class="instruction">LD A,$01</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=01.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70d4"></span>70D4</td>
<td class="instruction">JR Z,<a href="7069.html#70da">$70DA</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="7069.html#70da">70DA</a> if <span class="register">HL</span> is equal to <span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="70d6"></span>70D6</td>
<td class="instruction">SLA A</td>
<td class="comment-1" rowspan="1">Shift <span class="register">A</span> left (with carry).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70d8"></span>70D8</td>
<td class="instruction">DJNZ <a href="7069.html#70d6">$70D6</a></td>
<td class="comment-1" rowspan="1">Decrease counter by one and loop back to <a href="7069.html#70d6">70D6</a> until counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="70da"></span>70DA</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="2">Restore <span class="register">DE</span> and <span class="register">BC</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70db"></span>70DB</td>
<td class="instruction">POP BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70dc"></span>70DC</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="2">Stash <span class="register">BC</span> and <span class="register">DE</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70dd"></span>70DD</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70de"></span>70DE</td>
<td class="instruction">LD HL,$669E</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="6696.html#669e">669E</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-2"><span id="70e1"></span>70E1</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">Increment <span class="register">HL</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70e2"></span>70E2</td>
<td class="instruction">DJNZ <a href="7069.html#70e1">$70E1</a></td>
<td class="comment-1" rowspan="1">Decrease counter by one and loop back to <a href="7069.html#70e1">70E1</a> until counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70e4"></span>70E4</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-1" rowspan="1">Write <span class="register">A</span> to *<span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="70e5"></span>70E5</td>
<td class="instruction">JR <a href="70E7.html#7147">$7147</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="70E7.html#7147">7147</a>.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="6CEE.html">6CEE</a>
</td>
<td class="up">Up: <a href="../maps/all.html#7069">Map</a></td>
<td class="next">
Next: <a href="70E7.html">70E7</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1983 Megadodo Software &copy; 2025 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.6.</div>
<div class="repository">Link to <a rel="noopener nofollow" href="https://github.com/pobtastic/pheenix/">Source code</a>.</div>
<div><a href="../dec/asm/28777.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>