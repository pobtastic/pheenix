<!DOCTYPE html>
<html>
<head>
<title>Pheenix: Routine at 68B8</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="68A1.html">68A1</a>
</td>
<td class="up">Up: <a href="../maps/all.html#68b8">Map</a></td>
<td class="next">
Next: <a href="6926.html">6926</a>
</td>
</tr>
</table>
<div class="description">68B8: Transition Effect</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="740C.html">InitialiseLevel</a>, <a href="7599.html">GameEntryPoint</a> and <a href="7C82.html">TitleScreen</a>.
</div>
<div class="paragraph">
Creates a transition effect where a rectangular frame grows outwards from the center of the screen, the colour varies depending on the current phase. Once the frame fills the whole screen, it then "erases" from the center outwards again.
</div>
<div class="paragraph">
This animation is also present in Phoenix, the arcade game this game is based on.
</div>
</div>
</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="68b8"></span>
<div class="comments">
<div class="paragraph">
Demonstrating the transition using INK:MAGENTA,
PAPER:BLACK (BRIGHT):  

 <table class="">
<tr>
<th colspan="4" rowspan="1">First Animation</th>
</tr>
<tr>
<th colspan="1" rowspan="1">Frame 00</th>
<th colspan="1" rowspan="1">Frame 01</th>
<th colspan="1" rowspan="1">Frame 02</th>
<th colspan="1" rowspan="1">Frame 03</th>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><img alt="transition-0" src="../images/scr/transition-0.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-1" src="../images/scr/transition-1.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-2" src="../images/scr/transition-2.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-3" src="../images/scr/transition-3.png" /></td>
</tr>
<tr>
<th colspan="1" rowspan="1">Frame 04</th>
<th colspan="1" rowspan="1">Frame 05</th>
<th colspan="1" rowspan="1">Frame 06</th>
<th colspan="1" rowspan="1">Frame 07</th>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><img alt="transition-4" src="../images/scr/transition-4.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-5" src="../images/scr/transition-5.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-6" src="../images/scr/transition-6.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-7" src="../images/scr/transition-7.png" /></td>
</tr>
<tr>
<th colspan="1" rowspan="1">Frame 08</th>
<th colspan="1" rowspan="1">Frame 09</th>
<th colspan="1" rowspan="1">Frame 0A</th>
<th colspan="1" rowspan="1">Frame 0B</th>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><img alt="transition-8" src="../images/scr/transition-8.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-9" src="../images/scr/transition-9.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-10" src="../images/scr/transition-10.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-11" src="../images/scr/transition-11.png" /></td>
</tr>
<tr>
<th colspan="4" rowspan="1">Second Animation</th>
</tr>
<tr>
<th colspan="1" rowspan="1">Frame 00</th>
<th colspan="1" rowspan="1">Frame 01</th>
<th colspan="1" rowspan="1">Frame 02</th>
<th colspan="1" rowspan="1">Frame 03</th>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><img alt="transition-12" src="../images/scr/transition-12.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-13" src="../images/scr/transition-13.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-14" src="../images/scr/transition-14.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-15" src="../images/scr/transition-15.png" /></td>
</tr>
<tr>
<th colspan="1" rowspan="1">Frame 04</th>
<th colspan="1" rowspan="1">Frame 05</th>
<th colspan="1" rowspan="1">Frame 06</th>
<th colspan="1" rowspan="1">Frame 07</th>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><img alt="transition-16" src="../images/scr/transition-16.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-17" src="../images/scr/transition-17.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-18" src="../images/scr/transition-18.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-19" src="../images/scr/transition-19.png" /></td>
</tr>
<tr>
<th colspan="1" rowspan="1">Frame 08</th>
<th colspan="1" rowspan="1">Frame 09</th>
<th colspan="1" rowspan="1">Frame 0A</th>
<th colspan="1" rowspan="1">Frame 0B</th>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><img alt="transition-20" src="../images/scr/transition-20.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-21" src="../images/scr/transition-21.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-22" src="../images/scr/transition-22.png" /></td>
<td class="" colspan="1" rowspan="1"><img alt="transition-23" src="../images/scr/transition-23.png" /></td>
</tr>
</table>
</div>
<div class="paragraph">
Which create the following animation: <table class="">
<tr>
<td class="" colspan="1" rowspan="1"><img alt="transition-animation" src="../images/udgs/transition-animation.png" /></td>
</tr>
</table>
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">TransitionEffect</td>
<td class="address-2"><span id="68b8"></span>68B8</td>
<td class="instruction">LD B,$02</td>
<td class="comment-1" rowspan="1">Set an iteration counter in <span class="register">B</span> for 02 animations.</td>
</tr>
<tr>
<td class="asm-label">TransitionEffect_Loop</td>
<td class="address-2"><span id="68ba"></span>68BA</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash the iteration counter on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68bb"></span>68BB</td>
<td class="instruction">LD DE,$0109</td>
<td class="comment-1" rowspan="1">Set <span class="register">DE</span> to initial frame dimensions (width=09, height=01).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68be"></span>68BE</td>
<td class="instruction">LD HL,$596B</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=596B (starting attribute buffer location).</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="68c1"></span>
<div class="comments">
<div class="paragraph">
Determine the attribute color for this iteration.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68c1"></span>68C1</td>
<td class="instruction">LD A,B</td>
<td class="comment-1" rowspan="2">Check if this is iteration 01?</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68c2"></span>68C2</td>
<td class="instruction">CP $01</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="68c4"></span>
<div class="comments">
<div class="paragraph">
The second time this loops around, the rectangular frame "erases" itself (which is just achieved by doing the same thing again but in BLACK).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68c4"></span>68C4</td>
<td class="instruction">LD A,$00</td>
<td class="comment-1" rowspan="1">Set the iteration colour to: INK:BLACK,
PAPER:BLACK.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68c6"></span>68C6</td>
<td class="instruction">JR Z,<a href="68B8.html#68d3">TransitionEffect_DrawFrame</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="68B8.html#68d3">TransitionEffect_DrawFrame</a> if this is iteration 01.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="68c8"></span>
<div class="comments">
<div class="paragraph">
Else, this is the first loop - so set the INK based on the current phase.
</div>
<div class="paragraph">
<table class="default">
<tr>
<th colspan="1" rowspan="1">Phase</th>
<th colspan="1" rowspan="1">Colour</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">00</td>
<td class="centre" colspan="1" rowspan="1">INK:MAGENTA, PAPER:BLACK</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">01</td>
<td class="centre" colspan="1" rowspan="1">INK:GREEN, PAPER:BLACK</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">02</td>
<td class="centre" colspan="1" rowspan="1">INK:CYAN, PAPER:BLACK</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">03</td>
<td class="centre" colspan="1" rowspan="1">INK:YELLOW, PAPER:BLACK</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">04</td>
<td class="centre" colspan="1" rowspan="1">INK:MAGENTA, PAPER:BLACK (BRIGHT)</td>
</tr>
</table>
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68c8"></span>68C8</td>
<td class="instruction">LD A,($66F1)</td>
<td class="comment-1" rowspan="2">Set the iteration colour to: *<a href="66F1.html">Phase</a>+03.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68cb"></span>68CB</td>
<td class="instruction">ADD A,$03</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68cd"></span>68CD</td>
<td class="instruction">CP $07</td>
<td class="comment-1" rowspan="2">Jump to <a href="68B8.html#68d3">TransitionEffect_DrawFrame</a> unless the colour is WHITE (for phase 04).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68cf"></span>68CF</td>
<td class="instruction">JR NZ,<a href="68B8.html#68d3">TransitionEffect_DrawFrame</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="68d1"></span>
<div class="comments">
<div class="paragraph">
Phase 04 uses INK:MAGENTA,
PAPER:BLACK (BRIGHT) instead of WHITE.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68d1"></span>68D1</td>
<td class="instruction">LD A,$43</td>
<td class="comment-1" rowspan="1">Set the iteration colour to: INK:MAGENTA,
PAPER:BLACK (BRIGHT).</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="68d3"></span>
<div class="comments">
<div class="paragraph">
There are 0C frames to fill the whole screen.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">TransitionEffect_DrawFrame</td>
<td class="address-2"><span id="68d3"></span>68D3</td>
<td class="instruction">LD B,$0C</td>
<td class="comment-1" rowspan="1">Set a counter in <span class="register">B</span> for 0C frames.</td>
</tr>
<tr>
<td class="asm-label">TransitionEffect_FrameLoop</td>
<td class="address-2"><span id="68d5"></span>68D5</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash the frame counter on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68d6"></span>68D6</td>
<td class="instruction">LD B,E</td>
<td class="comment-1" rowspan="1">Set the horizontal counter from <span class="register">E</span> (frame width).</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="68d7"></span>
<div class="comments">
<div class="paragraph">
Draw the top edge of the frame (left to right).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">TransitionEffect_TopEdge</td>
<td class="address-2"><span id="68d7"></span>68D7</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-1" rowspan="1">Write the attribute byte to the attribute buffer.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68d8"></span>68D8</td>
<td class="instruction">CALL <a href="68A1.html">Print_Asterisk</a></td>
<td class="comment-1" rowspan="1">Call <a href="68A1.html">Print_Asterisk</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68db"></span>68DB</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">Move the attribute address pointer right one block.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68dc"></span>68DC</td>
<td class="instruction">DJNZ <a href="68B8.html#68d7">TransitionEffect_TopEdge</a></td>
<td class="comment-1" rowspan="1">Decrease the horizontal counter by one and loop back to <a href="68B8.html#68d7">TransitionEffect_TopEdge</a> until the top edge of the frame has been drawn.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68de"></span>68DE</td>
<td class="instruction">LD B,D</td>
<td class="comment-1" rowspan="1">Set the vertical counter from <span class="register">D</span> (frame height).</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="68df"></span>
<div class="comments">
<div class="paragraph">
Draw the right edge of the frame (top to bottom).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">TransitionEffect_RightEdge</td>
<td class="address-2"><span id="68df"></span>68DF</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash the vertical counter on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68e0"></span>68E0</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-1" rowspan="1">Write the attribute byte to the attribute buffer.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68e1"></span>68E1</td>
<td class="instruction">CALL <a href="68A1.html">Print_Asterisk</a></td>
<td class="comment-1" rowspan="1">Call <a href="68A1.html">Print_Asterisk</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68e4"></span>68E4</td>
<td class="instruction">LD BC,$0020</td>
<td class="comment-1" rowspan="2">Move down one row (add 0020 to the attribute address).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68e7"></span>68E7</td>
<td class="instruction">ADD HL,BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68e8"></span>68E8</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore the vertical counter from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68e9"></span>68E9</td>
<td class="instruction">DJNZ <a href="68B8.html#68df">TransitionEffect_RightEdge</a></td>
<td class="comment-1" rowspan="1">Decrease the vertical counter by one and loop back to <a href="68B8.html#68df">TransitionEffect_RightEdge</a> until the right edge of the frame has been drawn.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68eb"></span>68EB</td>
<td class="instruction">LD B,E</td>
<td class="comment-1" rowspan="1">Set the horizontal counter from <span class="register">E</span> (frame width).</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="68ec"></span>
<div class="comments">
<div class="paragraph">
Draw the bottom edge of the frame (right to left).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">TransitionEffect_BottomEdge</td>
<td class="address-2"><span id="68ec"></span>68EC</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-1" rowspan="1">Write the attribute byte to the attribute buffer.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68ed"></span>68ED</td>
<td class="instruction">CALL <a href="68A1.html">Print_Asterisk</a></td>
<td class="comment-1" rowspan="1">Call <a href="68A1.html">Print_Asterisk</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68f0"></span>68F0</td>
<td class="instruction">DEC HL</td>
<td class="comment-1" rowspan="1">Move the attribute address pointer left one block.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68f1"></span>68F1</td>
<td class="instruction">DJNZ <a href="68B8.html#68ec">TransitionEffect_BottomEdge</a></td>
<td class="comment-1" rowspan="1">Decrease the horizontal counter by one and loop back to <a href="68B8.html#68ec">TransitionEffect_BottomEdge</a> until the bottom edge of the frame has been drawn.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68f3"></span>68F3</td>
<td class="instruction">LD B,D</td>
<td class="comment-1" rowspan="1">Set the vertical counter from <span class="register">D</span> (frame height).</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="68f4"></span>
<div class="comments">
<div class="paragraph">
Draw the left edge of the frame (bottom to top).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">TransitionEffect_LeftEdge</td>
<td class="address-2"><span id="68f4"></span>68F4</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash the vertical counter on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68f5"></span>68F5</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-1" rowspan="1">Write the attribute byte to the attribute buffer.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68f6"></span>68F6</td>
<td class="instruction">CALL <a href="68A1.html">Print_Asterisk</a></td>
<td class="comment-1" rowspan="1">Call <a href="68A1.html">Print_Asterisk</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68f9"></span>68F9</td>
<td class="instruction">LD BC,$0020</td>
<td class="comment-1" rowspan="3">Move up one row (subtract 0020 from the attribute address).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68fc"></span>68FC</td>
<td class="instruction">AND A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68fd"></span>68FD</td>
<td class="instruction">SBC HL,BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="68ff"></span>68FF</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore the vertical counter from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6900"></span>6900</td>
<td class="instruction">DJNZ <a href="68B8.html#68f4">TransitionEffect_LeftEdge</a></td>
<td class="comment-1" rowspan="1">Decrease the vertical counter by one and loop back to <a href="68B8.html#68f4">TransitionEffect_LeftEdge</a> until the left edge of the frame has been drawn.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="6902"></span>
<div class="comments">
<div class="paragraph">
Move outward to the next frame.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6902"></span>6902</td>
<td class="instruction">LD C,$21</td>
<td class="comment-1" rowspan="2">Move up one row and left one block (subtract 0021 from the attribute address).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6904"></span>6904</td>
<td class="instruction">SBC HL,BC</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="6906"></span>
<div class="comments">
<div class="paragraph">
Increase the frame dimensions.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6906"></span>6906</td>
<td class="instruction">INC E</td>
<td class="comment-1" rowspan="2">Increment frame width by two.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6907"></span>6907</td>
<td class="instruction">INC E</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6908"></span>6908</td>
<td class="instruction">INC D</td>
<td class="comment-1" rowspan="2">Increment the frame height by two.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6909"></span>6909</td>
<td class="instruction">INC D</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="690a"></span>
<div class="comments">
<div class="paragraph">
Action a delay between the frames.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="690a"></span>690A</td>
<td class="instruction">PUSH AF</td>
<td class="comment-1" rowspan="1">Stash the attribute byte on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="690b"></span>690B</td>
<td class="instruction">LD BC,$000A</td>
<td class="comment-1" rowspan="1">Set a frame delay counter in <span class="register">BC</span> to 0100*0A loops.</td>
</tr>
<tr>
<td class="asm-label">TransitionEffect_FrameDelay</td>
<td class="address-2"><span id="690e"></span>690E</td>
<td class="instruction">DJNZ <a href="68B8.html#690e">TransitionEffect_FrameDelay</a></td>
<td class="comment-1" rowspan="1">Decrease the inner loop counter by one and loop back to <a href="68B8.html#690e">TransitionEffect_FrameDelay</a> until the inner loop counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6910"></span>6910</td>
<td class="instruction">DEC C</td>
<td class="comment-1" rowspan="1">Decrease the outer loop counter by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6911"></span>6911</td>
<td class="instruction">JR NZ,<a href="68B8.html#690e">TransitionEffect_FrameDelay</a></td>
<td class="comment-1" rowspan="1">Jump back to <a href="68B8.html#690e">TransitionEffect_FrameDelay</a> until the outer loop counter is zero.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="6913"></span>
<div class="comments">
<div class="paragraph">
Process the next frame loop (or pass through when it's completed).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6913"></span>6913</td>
<td class="instruction">POP AF</td>
<td class="comment-1" rowspan="2">Restore the attribute byte and frame counter from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6914"></span>6914</td>
<td class="instruction">POP BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6915"></span>6915</td>
<td class="instruction">DJNZ <a href="68B8.html#68d5">TransitionEffect_FrameLoop</a></td>
<td class="comment-1" rowspan="1">Decrease the frame counter by one and loop back to <a href="68B8.html#68d5">TransitionEffect_FrameLoop</a> until the counter is zero.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="6917"></span>
<div class="comments">
<div class="paragraph">
Action a delay between the iterations.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6917"></span>6917</td>
<td class="instruction">LD BC,$0032</td>
<td class="comment-1" rowspan="1">Set an iteration delay counter in <span class="register">BC</span> to 0100*32 loops.</td>
</tr>
<tr>
<td class="asm-label">TransitionEffect_DelayLoop</td>
<td class="address-2"><span id="691a"></span>691A</td>
<td class="instruction">DJNZ <a href="68B8.html#691a">TransitionEffect_DelayLoop</a></td>
<td class="comment-1" rowspan="1">Decrease the inner loop counter by one and loop back to <a href="68B8.html#691a">TransitionEffect_DelayLoop</a> until the inner loop counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="691c"></span>691C</td>
<td class="instruction">DEC C</td>
<td class="comment-1" rowspan="1">Decrease the outer loop counter by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="691d"></span>691D</td>
<td class="instruction">JR NZ,<a href="68B8.html#691a">TransitionEffect_DelayLoop</a></td>
<td class="comment-1" rowspan="1">Jump back to <a href="68B8.html#691a">TransitionEffect_DelayLoop</a> until the outer loop counter is zero.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="691f"></span>
<div class="comments">
<div class="paragraph">
Process the next iteration animation (or pass through and end).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="691f"></span>691F</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore the iteration counter from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6920"></span>6920</td>
<td class="instruction">DJNZ <a href="68B8.html#68ba">TransitionEffect_Loop</a></td>
<td class="comment-1" rowspan="1">Decrease the iteration counter by one and loop back to <a href="68B8.html#68ba">TransitionEffect_Loop</a> until the animation is complete.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="6922"></span>
<div class="comments">
<div class="paragraph">
All done, clear the screen and return.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6922"></span>6922</td>
<td class="instruction">CALL <a href="6720.html">ClearScreen</a></td>
<td class="comment-1" rowspan="1">Call <a href="6720.html">ClearScreen</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="6925"></span>6925</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="68A1.html">68A1</a>
</td>
<td class="up">Up: <a href="../maps/all.html#68b8">Map</a></td>
<td class="next">
Next: <a href="6926.html">6926</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1983 Megadodo Software &copy; 2025 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.6.</div>
<div class="repository">Link to <a rel="noopener nofollow" href="https://github.com/pobtastic/pheenix/">Source code</a>.</div>
<div><a href="../dec/asm/26808.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>